<ion-view ng-controller="recentBattlesController" title="Recent battles" id="page4">

  <ion-nav-bar class="bar-balanced gradient" align-title="center">
        <ion-nav-back-button class="button-icon ion-ios-arrow-left">
        </ion-nav-back-button>
    </ion-nav-bar>

  <ion-content padding="true" class="has-header">
    <ion-refresher
      pulling-text="Update..."
      on-refresh="fetchBattles()">
    </ion-refresher>

    <div id="profile-button-bar2" class="button-bar"></div>

    <div id="profile-button-bar1" class="button-bar"></div>

    <ion-list ng-init="fetchRecentBattles()" id="profile-list5" class="project-list row">

      <div ng-if="!empty_battles" style="padding:0;" class="bar item-input-inset bar-light">
        <label class="item-input-wrapper">
          <i class="icon ion-search placeholder-icon"></i>
          <input type="search" ng-model="query" placeholder="Search battles" value="">
        </label>
      </div>
      <div class="item item-divider">

        <!-- show invites you've sent || you're player1 -->
        <h4 id="profile-heading1" style="color:#000000;"> Showing 30 recent battles</h4>
      </div>

      <ion-item ng-repeat='item in battles | filter: query' class="item-thumbnail-left item-icon-right" id="profile-list-item6">

        <div>
          <img class="project_image" style="max-width: 60px !important;" src='{{item.project_1.src_path}}{{item.project_1.stage}}.png'>
          <h2>{{item.project_1.name}}</h2>
          <p style="white-space:normal;">Project leader<span ng-if="item.project_1.player2 !== ''">s</span>

            <a href="#" ng-click="view_player_profile({{item.project_1.player1_id}})"> {{item.project_1.player1}}</a>
            <span ng-if="item.project_1.player2 !== ''">and</span>
            <a href="#" ng-click="view_player_profile({{item.project_1.player_id}})"> {{item.project_1.player2}}</a>
            <br>

            <div ng-if="item.project_winner === item.project_1.id">
              <h3>Resources won</h3>
              <p ng-if="item.battle_winner_reward_pet !== '0'" class="ion-ios-paw"> {{item.battle_winner_reward_pet}}</p>
              <p ng-if="item.battle_winner_reward_bitfunds !== '0'" class="ion-cash"> {{item.battle_winner_reward_bitfunds}}</p>
              <p class="ion-ios-nutrition"> Resource bundle</p>
            </div>

          </p>
          <p>
        </div>

        <h2 style="padding:8%;">VS</h2>

        <div>
          <img class="project_image" style="position:relative;" src='{{item.project_2.src_path}}{{item.project_2.stage}}.png'>
          <h2>{{item.project_2.name}}</h2>
          <p style="white-space:normal;">Pet owner<span ng-if="item.project_2.player2 !== ''">s</span>

            <a href="#" ng-click="view_player_profile({{item.project_2.player1_id}})"> {{item.project_2.player1}}</a>
            <span ng-if="item.project_2.player2 !== ''">and</span>
            <a href="#" ng-click="view_player_profile({{item.project_2.player_id}})"> {{item.project_2.player2}}</a>
            <br>


          <div ng-if="item.project_winner === item.project_2.id">
            <h3>Resources won</h3>
            <p ng-if="item.battle_winner_reward_pet !== '0' || item.battle_winner_reward_pet !== null" class="ion-ios-paw"> {{item.battle_winner_reward_pet}}</p>
            <p ng-if="item.battle_winner_reward_bitfunds !== '0'" class="ion-cash"> {{item.battle_winner_reward_bitfunds}}</p>
            <p class="ion-ios-nutrition"> Resource bundle</p>
          </div>

          </p>
          <p>
        </div>




        </p>
      </ion-item>

    </ion-list>

  </ion-content>
</ion-view>
